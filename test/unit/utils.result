test_run = require('test_run').new()
---
...
utils = require('vshard.util')
---
...
localcfg = require('localcfg')
---
...
json = require('json')
---
...
cfg = table.deepcopy(localcfg)
---
...
cfg.B = localcfg
---
...
cfg.A = localcfg
---
...
cfg.C = localcfg
---
...
cfg_string = utils.consistent_json(cfg)
---
...
cfg_string
---
- '{"A":{"memtx_memory":104857600,"sharding":{"ac522f65-aa94-4134-9f64-51ee384f1a54":{"replicas":{"001688c3-66f8-4a31-8e19-036c17d489c2":{"name":"storage_2_b","uri":"storage:storage@127.0.0.1:3304"},"1e02ae8a-afc0-4e91-ba34-843a356b8ed7":{"master":true,"name":"storage_2_a","uri":"storage:storage@127.0.0.1:3303"}}},"cbf06940-0790-498b-948d-042b62cf3d29":{"replicas":{"3de2e3e1-9ebe-4d0d-abb1-26d301b84633":{"name":"storage_1_b","uri":"storage:storage@127.0.0.1:3302"},"8a274925-a26d-47fc-9e1b-af88ce939412":{"master":true,"name":"storage_1_a","uri":"storage:storage@127.0.0.1:3301"}}}}},"B":{"memtx_memory":104857600,"sharding":{"ac522f65-aa94-4134-9f64-51ee384f1a54":{"replicas":{"001688c3-66f8-4a31-8e19-036c17d489c2":{"name":"storage_2_b","uri":"storage:storage@127.0.0.1:3304"},"1e02ae8a-afc0-4e91-ba34-843a356b8ed7":{"master":true,"name":"storage_2_a","uri":"storage:storage@127.0.0.1:3303"}}},"cbf06940-0790-498b-948d-042b62cf3d29":{"replicas":{"3de2e3e1-9ebe-4d0d-abb1-26d301b84633":{"name":"storage_1_b","uri":"storage:storage@127.0.0.1:3302"},"8a274925-a26d-47fc-9e1b-af88ce939412":{"master":true,"name":"storage_1_a","uri":"storage:storage@127.0.0.1:3301"}}}}},"C":{"memtx_memory":104857600,"sharding":{"ac522f65-aa94-4134-9f64-51ee384f1a54":{"replicas":{"001688c3-66f8-4a31-8e19-036c17d489c2":{"name":"storage_2_b","uri":"storage:storage@127.0.0.1:3304"},"1e02ae8a-afc0-4e91-ba34-843a356b8ed7":{"master":true,"name":"storage_2_a","uri":"storage:storage@127.0.0.1:3303"}}},"cbf06940-0790-498b-948d-042b62cf3d29":{"replicas":{"3de2e3e1-9ebe-4d0d-abb1-26d301b84633":{"name":"storage_1_b","uri":"storage:storage@127.0.0.1:3302"},"8a274925-a26d-47fc-9e1b-af88ce939412":{"master":true,"name":"storage_1_a","uri":"storage:storage@127.0.0.1:3301"}}}}},"memtx_memory":104857600,"sharding":{"ac522f65-aa94-4134-9f64-51ee384f1a54":{"replicas":{"001688c3-66f8-4a31-8e19-036c17d489c2":{"name":"storage_2_b","uri":"storage:storage@127.0.0.1:3304"},"1e02ae8a-afc0-4e91-ba34-843a356b8ed7":{"master":true,"name":"storage_2_a","uri":"storage:storage@127.0.0.1:3303"}}},"cbf06940-0790-498b-948d-042b62cf3d29":{"replicas":{"3de2e3e1-9ebe-4d0d-abb1-26d301b84633":{"name":"storage_1_b","uri":"storage:storage@127.0.0.1:3302"},"8a274925-a26d-47fc-9e1b-af88ce939412":{"master":true,"name":"storage_1_a","uri":"storage:storage@127.0.0.1:3301"}}}}}'
...
restored_cfg = json.decode(cfg_string)
---
...
cfg_string == utils.consistent_json(restored_cfg)
---
- true
...
